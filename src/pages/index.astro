---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_DESCRIPTION, SITE_TITLE, DOC_SOURCE_URL } from '../consts';
import { getEntry, render } from 'astro:content';

const doc = await getEntry('docs', 'filesystem');

if (!doc) {
	throw new Error('Filesystem doc is missing');
}

const { Content } = await render(doc);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead
			title={doc.data.title ?? SITE_TITLE}
			description={doc.data.description ?? SITE_DESCRIPTION}
		/>
		<style>
			.page-hero {
				margin-bottom: 2rem;
			}
			.eyebrow {
				text-transform: uppercase;
				letter-spacing: 0.08em;
				font-size: 0.8em;
				color: rgb(var(--gray));
				margin: 0 0 0.4rem 0;
			}
			.lede {
				max-width: 52ch;
			}
			.cta {
				display: flex;
				flex-wrap: wrap;
				gap: 0.75rem;
				margin-top: 1rem;
			}
			.button,
			.ghost {
				display: inline-block;
				padding: 0.65rem 1.1rem;
				border-radius: 999px;
				text-decoration: none;
				font-weight: 700;
				border: 2px solid transparent;
			}
			.button {
				background: rgb(var(--black));
				color: white;
			}
			.ghost {
				border-color: rgb(var(--black));
				color: rgb(var(--black));
			}
			.doc {
				background: white;
				border-radius: 16px;
				box-shadow: var(--box-shadow);
				padding: 1.5rem;
			}
			.doc :is(h2, h3) {
				margin-top: 1.5rem;
			}
			.source-note {
				margin-top: 2rem;
				font-size: 0.95rem;
				color: rgb(var(--gray));
			}
			@media (max-width: 720px) {
				.button,
				.ghost {
					width: 100%;
					text-align: center;
				}
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<header class="page-hero">
				<p class="eyebrow">{SITE_TITLE}</p>
				<h1>{doc.data.title}</h1>
				<p class="lede">{doc.data.description}</p>
				<div class="cta">
					<a class="button" href="#doc">Read online</a>
					<a class="ghost" href={doc.data.source ?? DOC_SOURCE_URL} target="_blank" rel="noreferrer"
						>Markdown source</a
					>
				</div>
			</header>

			<article id="doc" class="doc">
				<Content />
				<p class="source-note">
					Prefer raw text?
					<a href={doc.data.source ?? DOC_SOURCE_URL} target="_blank" rel="noreferrer"
						>Open the Markdown file</a
					>.
				</p>
			</article>
		</main>
		<Footer />
	</body>
</html>
